lots of refactorings to do